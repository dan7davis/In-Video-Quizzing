<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Quiz-A</title>
	    <!-- Survey.js -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="js/survey.jquery.js"></script>
    <link rel="stylesheet" href="css/survey.css"/>
    <link rel="stylesheet" href="css/index-Q.css"/>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">


</head>
<p id="user"></p> 
<body>


	<h2>Quiz A: Instructions</h2>

  <p>You can click "back to video" to revisit the video to help answer the questions.</p>

  <p>You are only allowed one attempt to submit answers to this quiz, so please take your time and answer the questions carefully.</p>

	<div id="surveyContainer"></div>

<div id="expand-box">

	<form action="Video-N.html">
	<button class="btn btn-primary" id="back" style="float: left">Back to Video</button>
	</form>

	<form action="guide.html">
	<button class="btn btn-primary disabled">Next Video Lecture</button>
	</form>

</div>

</body>

<script>

var name = localStorage.getItem("exp_id")
$("#user").text("You are user: "+ name)
var videoID = document.title;

var settings;

function sendData() {
  settings = {
  "async": true,
  "crossDomain": true,
  "url": "https://crowd-events.herokuapp.com/api/events",
  "method": "POST",
  "data": {
    "name": name,
    "action": actionBody,
    "video": videoID
  }
}


  $.ajax(settings).done(function (response) {
    console.log(response);
  });
}



var surveyJSON = {pages:[{
  name:"page1",elements:[{
  type:"radiogroup",
  name:"question1",
  title:"In 1994, the Spanish cyclist Miguel Indurain set a world hour record of 53,040 meters in 1 hour. Spanish scientists measured an average power of 509.5 watts produced by him during that hour. What is the energy generated by him in that hour expressed in kWh?",isRequired:true,choices:[{
    value:"item1",text:"50 kWh"},
    {value:"item2",text:"0.5 kWh"},
    {value:"item3",text:"100 kWh"},]},
    {type:"radiogroup",
    name:"question2",
    title:"If 1 kWh equals 3.6 MJ, how many million joules (MJ) is equivalent to 2.5 kWh?",isRequired:true,choices:[{
      value:"item1",text:"90 MJ"},
      {value:"item2",text:"27 MJ"},
      {value:"item3",text:"4.5 MJ"},
      {value:"item4",text:"9 MJ"}]},
      {type:"radiogroup",
      name:"question3",
      title:"According to the map in the video, which of the following countries has the highest energy consumption per capita?",isRequired:true,choices:[{
        value:"item1",text:"China"},
        {value:"item2",text:"Brazil"},
        {value:"item3",text:"Russia"},
        {value:"item4",text:"Australia"}]},
        {type:"radiogroup",
        name:"question4",
        title:"What is the scientific definition of energy, according to the video?",isRequired:true,choices:[{
          value:"item1",text:"The capacity of a system to perform work."},
          {value:"item2",text:"The transportation of matter between states."},
          {value:"item3",text:"The ability to produce electricity."},
          {value:"item4",text:"The ability to create power."}]}]}]}

function sendDataToServer(survey) {
    //send Ajax request to your web server.
    actionBody = JSON.stringify(survey.data);
    sendData();
    $("button").attr('class', 'btn btn-primary');
    $("button#back").css('display', 'none');
}

var survey = new Survey.Model(surveyJSON);
$("#surveyContainer").Survey({
    model: survey,
    onComplete: sendDataToServer
});


$( document ).ready(function() {
    actionBody = String("Page loaded");
    sendData();
    var tabCount = Number(localStorage.getItem("tabCount")) - 1;
    if(tabCount > 4){
      document.removeChild(document.documentElement);	  
    }
});



document.addEventListener("visibilitychange", function() {
  console.log( document.visibilityState );
  if(document.visibilityState == "hidden"){
    tabCount += 1;
    localStorage.setItem("tabCount", tabCount);
    actionBody = String("hidden " + tabCount);
    sendData();
    if(tabCount > 4){
      document.removeChild(document.documentElement);	  
    }
    alertify.confirm("Warning: You left the tab " + tabCount + "/4 times.", function () {
          // user clicked "ok"
      }, function() {
          // user clicked "cancel"
    }).set('basic', true).closeOthers();
  } else {    
    actionBody = String("visible");
    sendData();
  }
});


</script>

<!-- JavaScript -->
<script src="./js/AlertifyJS-master/build/alertify.min.js"></script>

<!-- CSS -->
<link rel="stylesheet" href="./js/AlertifyJS-master/build/css/alertify.min.css" />
<!-- include a theme -->
<link rel="stylesheet" href="./js/AlertifyJS-master/build/css/themes/semantic.css" />

</html>
